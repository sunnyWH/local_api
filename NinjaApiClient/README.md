# Ninja API Client
This is example code that you can use to bootstrap your own Ninja API client.

The code and its dependencies are managed by [Poetry](https://python-poetry.org/). If you are using this project to bootstrap your own client code, it is recommended that you install and use Poetry.

Once Poetry is installed on your system, a simple `poetry init` in the directory where this README.md resides will install all the project's dependencies.

All the code resides in the `ninja_api_client` package. The entry point for this project is `run_clients.py`. To run the client code, type `poetry env activate` to enter your virtual environment, `cd ninja_api_client`, and run `python run_clients.py`.  

Before you dive in, you will want to set a few environment variables or populate a `.env` file in the `ninja_api_client` directory. 
| Key                                | Presence | Description |
| ------                             | ------   | ------      |
| `NINJA_API_TRADING_HOST`           | required | host of the trading Ninja    |
| `NINJA_API_TRADING_PORT`           | required | port of the trading Ninja    |
| `NINJA_API_TRADING_USER`           | required | username for trading |
| `NINJA_API_TRADING_PASSWORD`       | required | password for the trading user |
| `NINJA_API_TRADING_ACCESS_TOKEN`   | required | token provided to connect |
| `NINJA_API_POSITIONS_HOST`         | optional | host to query position information |
| `NINJA_API_POSITIONS_PORT`         | optional | port to query position information |
| `NINJA_API_POSITIONS_ACCESS_TOKEN` | optional | token provided to connect       |

The `NINJA_API_TRADING_USER` and `NINJA_API_TRADING_PASSWORD` will be the username and password you use to log in to your OptionsFe. The other values will be provided to you by the trade support team.

Diving into the code a bit, you will notice that `run_clients.py` creates a trading client and optionally a positions client if a `NINJA_API_POSITIONS_ACCESS_TOKEN` is set. As the API continues to evolve, more clients will be added.

That being said, the code that will be most helpful to modify initially is `trading_client.py` and `position_client.py`. In both modules, the `run` method is the starting point. Feel free to create additional threads or modify this function however you would like. Right now, these functions simply sends a login message, demo sending a handful of other messages, and exits after receiving three heartbeats. While this is useful for demonstrating how to send and receive API messages, it is not useful for actually trading.

You'll notice that the `TradingClient` and `PositionClient` classes are children of the `NinjaApiClient` class. There is a wealth of common logic in the `NinjaApiClient` class. Feel free to check it out, as there are several useful functions within.

There are a lot of other files in the `ninja_api_client` package. Generally speaking, you should never modify any files ending in `_pb2.py` or `.proto`. The former are generated by the `protoc` transpiler and allow you to interact with the interface we designed. The `.proto` files contain the messages and definitions (i.e., the language) that you will be using to communicate with the API. These files are a helpful reference and can also be passed to a `protoc` transpiler installed locally to generate source code for other programming languages. If you modify a `.proto` file, the language your client is speaking will differ from the language of our server, and this will result in negative outcomes.

One other helpful note: we used protobuf version 3.15.8 to develop this API. You'll notice this is the version in the `pyproject.toml` file. While it is not strictly necessary, it will be beneficial to stick to this version of protobuf to ensure our server and client match as closely as possible.
